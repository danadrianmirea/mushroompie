                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.1.6 #12533 (MINGW32)
                                      4 ;--------------------------------------------------------
                                      5 	.module 00_bank_stack
                                      6 	.optsdcc -mgbz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _get_bank
                                     12 	.globl _set_bank
                                     13 	.globl _pop_bank
                                     14 	.globl _push_bank
                                     15 	.globl ___banks_sp
                                     16 	.globl ___banks_storage
                                     17 ;--------------------------------------------------------
                                     18 ; special function registers
                                     19 ;--------------------------------------------------------
                                     20 ;--------------------------------------------------------
                                     21 ; ram data
                                     22 ;--------------------------------------------------------
                                     23 	.area _DATA
                                     24 ;--------------------------------------------------------
                                     25 ; ram data
                                     26 ;--------------------------------------------------------
                                     27 	.area _INITIALIZED
      000000                         28 ___banks_storage::
      000000                         29 	.ds 8
      000008                         30 ___banks_sp::
      000008                         31 	.ds 2
                                     32 ;--------------------------------------------------------
                                     33 ; absolute external ram data
                                     34 ;--------------------------------------------------------
                                     35 	.area _DABS (ABS)
                                     36 ;--------------------------------------------------------
                                     37 ; global & static initialisations
                                     38 ;--------------------------------------------------------
                                     39 	.area _HOME
                                     40 	.area _GSINIT
                                     41 	.area _GSFINAL
                                     42 	.area _GSINIT
                                     43 ;--------------------------------------------------------
                                     44 ; Home
                                     45 ;--------------------------------------------------------
                                     46 	.area _HOME
                                     47 ;src/00_bank_stack.c:6: void push_bank(const unsigned char n) NONBANKED {
                                     48 ;	---------------------------------
                                     49 ; Function push_bank
                                     50 ; ---------------------------------
      000000                         51 _push_bank::
                                     52 ;src/00_bank_stack.c:7: *(++__banks_sp) = n;
      000000 21r08r00                53 	ld	hl, #___banks_sp
      000003 34                      54 	inc	(hl)
      000004 20 02                   55 	jr	NZ, 00103$
      000006 23                      56 	inc	hl
      000007 34                      57 	inc	(hl)
      000008                         58 00103$:
      000008 21r08r00                59 	ld	hl, #___banks_sp
      00000B 2A                      60 	ld	a, (hl+)
      00000C 4F                      61 	ld	c, a
      00000D 46                      62 	ld	b, (hl)
      00000E F8 02                   63 	ldhl	sp,	#2
      000010 7E                      64 	ld	a, (hl)
      000011 02                      65 	ld	(bc), a
                                     66 ;src/00_bank_stack.c:8: SWITCH_ROM_MBC1(n);
      000012 7E                      67 	ld	a, (hl)
      000013 E0r00                   68 	ldh	(__current_bank + 0), a
      000015 11 00 20                69 	ld	de, #0x2000
      000018 7E                      70 	ld	a, (hl)
      000019 12                      71 	ld	(de), a
                                     72 ;src/00_bank_stack.c:9: }
      00001A C9                      73 	ret
                                     74 ;src/00_bank_stack.c:11: void pop_bank() NONBANKED {
                                     75 ;	---------------------------------
                                     76 ; Function pop_bank
                                     77 ; ---------------------------------
      00001B                         78 _pop_bank::
                                     79 ;src/00_bank_stack.c:12: unsigned char n = *(--__banks_sp);
      00001B 21r08r00                80 	ld	hl, #___banks_sp
      00001E 2A                      81 	ld	a, (hl+)
      00001F 5F                      82 	ld	e, a
      000020 3A                      83 	ld	a, (hl-)
      000021 57                      84 	ld	d, a
      000022 1B                      85 	dec	de
      000023 7B                      86 	ld	a, e
      000024 22                      87 	ld	(hl+), a
      000025 7A                      88 	ld	a, d
      000026 32                      89 	ld	(hl-), a
      000027 2A                      90 	ld	a, (hl+)
      000028 4F                      91 	ld	c, a
      000029 46                      92 	ld	b, (hl)
      00002A 0A                      93 	ld	a, (bc)
                                     94 ;src/00_bank_stack.c:13: SWITCH_ROM_MBC1(n);
      00002B E0r00                   95 	ldh	(__current_bank + 0), a
      00002D EA 00 20                96 	ld	(#0x2000),a
                                     97 ;src/00_bank_stack.c:14: }
      000030 C9                      98 	ret
                                     99 ;src/00_bank_stack.c:16: void set_bank(const unsigned char n) NONBANKED {
                                    100 ;	---------------------------------
                                    101 ; Function set_bank
                                    102 ; ---------------------------------
      000031                        103 _set_bank::
                                    104 ;src/00_bank_stack.c:17: *__banks_sp = n;
      000031 21r08r00               105 	ld	hl, #___banks_sp
      000034 2A                     106 	ld	a, (hl+)
      000035 4F                     107 	ld	c, a
      000036 46                     108 	ld	b, (hl)
      000037 F8 02                  109 	ldhl	sp,	#2
      000039 7E                     110 	ld	a, (hl)
      00003A 02                     111 	ld	(bc), a
                                    112 ;src/00_bank_stack.c:18: SWITCH_ROM_MBC1(n);
      00003B 7E                     113 	ld	a, (hl)
      00003C E0r00                  114 	ldh	(__current_bank + 0), a
      00003E 11 00 20               115 	ld	de, #0x2000
      000041 7E                     116 	ld	a, (hl)
      000042 12                     117 	ld	(de), a
                                    118 ;src/00_bank_stack.c:19: }
      000043 C9                     119 	ret
                                    120 ;src/00_bank_stack.c:21: unsigned char get_bank() NONBANKED {
                                    121 ;	---------------------------------
                                    122 ; Function get_bank
                                    123 ; ---------------------------------
      000044                        124 _get_bank::
                                    125 ;src/00_bank_stack.c:22: return (*__banks_sp);
      000044 21r08r00               126 	ld	hl, #___banks_sp
      000047 6E                     127 	ld	l, (hl)
                                    128 ;	spillPairReg hl
                                    129 ;	spillPairReg hl
      000048 FAr09r00               130 	ld	a, (___banks_sp + 1)
      00004B 67                     131 	ld	h, a
                                    132 ;	spillPairReg hl
                                    133 ;	spillPairReg hl
      00004C 5E                     134 	ld	e, (hl)
                                    135 ;src/00_bank_stack.c:23: }
      00004D C9                     136 	ret
                                    137 	.area _HOME
                                    138 ;--------------------------------------------------------
                                    139 ; code
                                    140 ;--------------------------------------------------------
                                    141 	.area _CODE
                                    142 	.area _CODE
                                    143 	.area _INITIALIZER
      000000                        144 __xinit____banks_storage:
      000000 00                     145 	.db #0x00	; 0
      000001 00                     146 	.db 0x00
      000002 00                     147 	.db 0x00
      000003 00                     148 	.db 0x00
      000004 00                     149 	.db 0x00
      000005 00                     150 	.db 0x00
      000006 00                     151 	.db 0x00
      000007 00                     152 	.db 0x00
      000008                        153 __xinit____banks_sp:
      000008r00r00                  154 	.dw ___banks_storage
                                    155 	.area _CABS (ABS)
